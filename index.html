<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù¾Ø§Ú©Ø³ØªØ§Ù† Ù†Ù…Ø§Ø² Ù¹Ø§Ø¦Ù… Ù¹ÛŒØ¨Ù„ - M.FAREED MUSTAFAI</title>
    <style>
        :root {
            --primary: #00695c;
            --accent: #ffa000;
            --bg: #f4f7f6;
            --card-bg: #ffffff;
            --text: #333;
            --danger: #c62828;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 10px;
            text-align: center;
        }

        .container { max-width: 1100px; margin: auto; }

        header {
            background: linear-gradient(135deg, var(--primary), #004d40);
            color: white;
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        h1 { margin: 0; font-size: 26px; }
        h2 { margin: 5px 0; font-size: 16px; opacity: 0.9; }
        .dev-name { display: block; margin-top: 10px; font-weight: bold; color: var(--accent); font-size: 22px; text-shadow: 1px 1px 2px rgba(0,0,0,0.5); }

        .selection-panel {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
        }

        .field-group { 
            flex: 1; 
            min-width: 250px; 
            text-align: right;
            position: relative;
        }
        
        .field-group label { 
            display: block; 
            font-weight: bold; 
            margin-bottom: 8px; 
            font-size: 14px; 
            color: var(--primary); 
        }

        .search-container {
            position: relative;
            width: 100%;
        }

        #citySearch {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 2px solid #ddd;
            font-size: 15px;
            font-family: inherit;
            background: white;
            box-sizing: border-box;
        }

        #citySearch:focus {
            border-color: var(--primary);
            outline: none;
        }

        .dropdown-content {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 0 0 8px 8px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            display: none;
            text-align: right;
        }

        .dropdown-content.active {
            display: block;
        }

        .city-item {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
            transition: background 0.2s;
            font-size: 14px;
        }

        .city-item:hover {
            background: #f5f5f5;
            color: var(--primary);
        }

        .city-item.selected {
            background: #e8f5e9;
            color: var(--primary);
            font-weight: bold;
        }

        .city-item .city-name-urdu {
            font-weight: bold;
        }
        
        .city-item .city-name-english {
            font-size: 11px;
            color: #666;
            margin-right: 8px;
        }

        .new-city-badge {
            background: var(--accent);
            color: black;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 4px;
            margin-right: 8px;
            font-weight: bold;
        }

        .today-card {
            background: linear-gradient(135deg, #00695c, #004d40);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .city-badge {
            background: var(--accent);
            color: black;
            padding: 5px 20px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 15px;
        }

        .date-info { 
            font-size: 18px; 
            margin-bottom: 15px; 
            line-height: 1.6; 
        }
        
        .hijri-date { 
            color: var(--accent); 
            font-weight: bold; 
            border-right: 2px solid rgba(255,255,255,0.3); 
            padding-right: 12px; 
            margin-right: 12px; 
        }

        .times-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
            gap: 12px;
        }

        .time-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .t-label { 
            font-size: 12px; 
            display: block; 
            margin-bottom: 5px; 
            opacity: 0.9; 
        }
        
        .t-val { 
            font-size: 18px; 
            font-weight: bold; 
        }
        
        .j-tag { 
            font-size: 11px; 
            color: var(--accent); 
            font-weight: bold; 
            display: block; 
            margin-top: 5px; 
        }

        .table-wrap {
            background: var(--card-bg);
            border-radius: 15px;
            overflow-x: auto;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }

        table { 
            width: 100%; 
            border-collapse: collapse; 
            font-size: 11px; 
            min-width: 1000px; 
        }
        
        th { 
            background: var(--primary); 
            color: white; 
            padding: 12px 5px; 
            position: sticky; 
            top: 0; 
        }
        
        td { 
            padding: 10px 4px; 
            border-bottom: 1px solid #eee; 
            text-align: center; 
        }
        
        .j-mini { 
            display: block; 
            font-size: 9px; 
            color: #00796b; 
            font-weight: bold; 
        }
        
        .danger { 
            color: var(--danger); 
            font-weight: bold; 
        }
        
        .active-day { 
            background: #fff9c4 !important; 
            font-weight: bold; 
            color: #000; 
        }

        footer {
            margin-top: 20px;
            font-size: 12px;
            color: #555;
            padding: 25px;
            background: #eee;
            border-radius: 20px;
            line-height: 1.8;
        }
        
        .footer-name { 
            margin-top: 15px; 
            font-weight: bold; 
            color: var(--primary); 
            font-size: 18px; 
        }
        
        .city-count {
            background: var(--primary);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
            margin-right: 10px;
        }
        
        .search-hint {
            font-size: 11px;
            color: #666;
            margin-top: 5px;
            text-align: right;
        }
        
        .new-city-message {
            background: #e8f5e9;
            color: #00695c;
            padding: 10px;
            border-radius: 8px;
            margin-top: 10px;
            font-size: 13px;
            border-right: 4px solid var(--accent);
            text-align: right;
        }
        
        .timezone-info {
            font-size: 11px;
            color: rgba(255,255,255,0.8);
            margin-top: 5px;
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>Ù†Ù…Ø§Ø² Ú©Û’ Ø§ÙˆÙ‚Ø§Øª Ú©Ø§ Ù¹Ø§Ø¦Ù… Ù¹ÛŒØ¨Ù„</h1>
        <h2>Ù…Ø·Ø§Ø¨Ù‚ Ø¯Ø§Ø±Ø§Ù„Ø§ÙØªØ§Ø¡ Ø§ÛÙ„Ø³Ù†Øª (Ø­Ù†ÙÛŒ)</h2>
        <span class="dev-name">M.FAREED MUSTAFAI</span>
    </header>

    <div class="selection-panel">
        <div class="field-group">
            <label>
                Ø´ÛØ± ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº 
                <span class="city-count">200+ Ø´ÛØ± + Ù†ÛŒØ§ Ø´ÛØ±</span>
            </label>
            <div class="search-container">
                <input 
                    type="text" 
                    id="citySearch" 
                    placeholder="Ø§Ø±Ø¯Ùˆ ÛŒØ§ Ø§Ù†Ú¯Ø±ÛŒØ²ÛŒ Ù…ÛŒÚº Ø´ÛØ± Ú©Ø§ Ù†Ø§Ù… Ù„Ú©Ú¾ÛŒÚº..."
                    autocomplete="off"
                >
                <div id="cityDropdown" class="dropdown-content"></div>
            </div>
            <div class="search-hint">
                ğŸ’¡ Ù†ÛŒØ§ Ø´ÛØ±: Ù†Ø§Ù… Ù„Ú©Ú¾ Ú©Ø± Ø§Ù†Ù¹Ø± Ø¯Ø¨Ø§Ø¦ÛŒÚºØŒ Ø´ÛØ± Ú©Ø§ Ø§ØµÙ„ ÙˆÙ‚Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø­Ø³Ø§Ø¨ ÛÙˆÚ¯Ø§
            </div>
        </div>
        <div class="field-group">
            <label>Ù…ÛÛŒÙ†Û Ù…Ù†ØªØ®Ø¨ Ú©Ø±ÛŒÚº</label>
            <select id="monthSelect" onchange="renderApp()">
                <option value="0">Ø¬Ù†ÙˆØ±ÛŒ</option>
                <option value="1">ÙØ±ÙˆØ±ÛŒ</option>
                <option value="2">Ù…Ø§Ø±Ú†</option>
                <option value="3">Ø§Ù¾Ø±ÛŒÙ„</option>
                <option value="4">Ù…Ø¦ÛŒ</option>
                <option value="5">Ø¬ÙˆÙ†</option>
                <option value="6">Ø¬ÙˆÙ„Ø§Ø¦ÛŒ</option>
                <option value="7">Ø§Ú¯Ø³Øª</option>
                <option value="8">Ø³ØªÙ…Ø¨Ø±</option>
                <option value="9">Ø§Ú©ØªÙˆØ¨Ø±</option>
                <option value="10">Ù†ÙˆÙ…Ø¨Ø±</option>
                <option value="11">Ø¯Ø³Ù…Ø¨Ø±</option>
            </select>
        </div>
    </div>

    <div id="newCityMessage" class="new-city-message" style="display: none;"></div>

    <div class="today-card">
        <div id="cityNameLabel" class="city-badge">Ú©Ø±Ø§Ú†ÛŒ</div>
        <div class="date-info" id="fullDateDisplay"></div>
        <div id="timezoneDisplay" class="timezone-info"></div>
        <div class="times-grid" id="cardGrid"></div>
    </div>

    <div class="table-wrap">
        <table>
            <thead>
                <tr>
                    <th>ØªØ§Ø±ÛŒØ®</th>
                    <th>ÙØ¬Ø±</th>
                    <th>Ø·Ù„ÙˆØ¹</th>
                    <th>Ø§Ø´Ø±Ø§Ù‚</th>
                    <th>Ú†Ø§Ø´Øª</th>
                    <th>Ø¶Ø­ÙˆÛƒ</th>
                    <th>Ù…Ù…Ù†ÙˆØ¹</th>
                    <th>Ø¸ÛØ±</th>
                    <th>Ø¹ØµØ±</th>
                    <th>Ù…ØºØ±Ø¨</th>
                    <th>Ø¹Ø´Ø§Ø¡</th>
                </tr>
            </thead>
            <tbody id="tableContent"></tbody>
        </table>
    </div>

    <footer>
        <b>Ø§ÛÙ… Ù…Ø¹Ù„ÙˆÙ…Ø§Øª:</b> ÛŒÛ Ø§ÙˆÙ‚Ø§Øª Ø¯Ø§Ø±Ø§Ù„Ø§ÙØªØ§Ø¡ Ø§ÛÙ„Ø³Ù†Øª Ú©Ø±Ø§Ú†ÛŒ Ú©Û’ Ø¯Ø§Ø¦Ù…ÛŒ Ù†Ù‚Ø´Û’ Ú©Û’ Ù…Ø·Ø§Ø¨Ù‚ ÛÛŒÚºÛ” <br>
        1. <b>Ø§Ø´Ø±Ø§Ù‚:</b> Ø·Ù„ÙˆØ¹ Ú©Û’ 20 Ù…Ù†Ù¹ Ø¨Ø¹Ø¯Û” 2. <b>Ú†Ø§Ø´Øª:</b> Ø·Ù„ÙˆØ¹ Ø§ÙˆØ± Ø¶Ø­ÙˆÛƒ Ú©Ø§ Ø¯Ø±Ù…ÛŒØ§Ù†ÛŒ ÙˆÙ‚ØªÛ”<br>
        3. <b>Ù…Ù…Ù†ÙˆØ¹ ÙˆÙ‚Øª:</b> Ø¸ÛØ± Ø³Û’ 20 Ù…Ù†Ù¹ Ù¾ÛÙ„Û’Û” 4. Ø¹ØµØ± Ùˆ Ø¹Ø´Ø§Ø¡ Ø®Ø§Ù„Øµ Ø­Ù†ÙÛŒ ÛÛŒÚºÛ”
        <div class="footer-name">Developed By: M.FAREED MUSTAFAI</div>
    </footer>
</div>

<script>
    // Ù¾Ø§Ú©Ø³ØªØ§Ù† Ú©Û’ Ø´ÛØ±ÙˆÚº Ú©Ø§ Ù…Ú©Ù…Ù„ ÚˆÛŒÙ¹Ø§ Ø¨ÛŒØ³
    const pakistanCitiesDatabase = {
        // ============== Ø³Ù†Ø¯Ú¾ ==============
        "Ú©Ø±Ø§Ú†ÛŒ": { lat: 24.8607, lon: 67.0011, region: "Ø³Ù†Ø¯Ú¾", offset: 0 },
        "Ø­ÛŒØ¯Ø±Ø¢Ø¨Ø§Ø¯": { lat: 25.3969, lon: 68.3578, region: "Ø³Ù†Ø¯Ú¾", offset: -3 },
        "Ø³Ú©Ú¾Ø±": { lat: 27.7312, lon: 68.7889, region: "Ø³Ù†Ø¯Ú¾", offset: -9 },
        "Ù„Ø§Ú‘Ú©Ø§Ù†Û": { lat: 27.5498, lon: 68.2120, region: "Ø³Ù†Ø¯Ú¾", offset: -8 },
        "Ø¨Ø¯ÛŒÙ†": { lat: 24.6564, lon: 68.8373, region: "Ø³Ù†Ø¯Ú¾", offset: 2 },
        "Ø¯Ø§Ø¯Ùˆ": { lat: 26.7333, lon: 67.7833, region: "Ø³Ù†Ø¯Ú¾", offset: -4 },
        "Ú¯Ú¾ÙˆÙ¹Ú©ÛŒ": { lat: 28.0044, lon: 69.3167, region: "Ø³Ù†Ø¯Ú¾", offset: -10 },
        "Ø¬ÛŒÚ©Ø¨ Ø¢Ø¨Ø§Ø¯": { lat: 28.2769, lon: 68.4514, region: "Ø³Ù†Ø¯Ú¾", offset: -14 },
        "Ø¬ÛŒÙ…Ø´ÙˆØ±Ùˆ": { lat: 25.4289, lon: 68.2808, region: "Ø³Ù†Ø¯Ú¾", offset: -4 },
        "Ú©Ø´Ù…ÙˆØ±": { lat: 28.4333, lon: 69.5833, region: "Ø³Ù†Ø¯Ú¾", offset: -16 },
        "Ø®ÛŒØ±Ù¾ÙˆØ±": { lat: 27.5333, lon: 68.7667, region: "Ø³Ù†Ø¯Ú¾", offset: -11 },
        "Ù…Ù¹ÛŒØ§Ø±ÛŒ": { lat: 25.5833, lon: 68.4333, region: "Ø³Ù†Ø¯Ú¾", offset: -4 },
        "Ù…ÛŒØ±Ù¾ÙˆØ± Ø®Ø§Øµ": { lat: 25.5275, lon: 69.0158, region: "Ø³Ù†Ø¯Ú¾", offset: -1 },
        "Ù†ÙˆØ§Ø¨Ø´Ø§Û": { lat: 26.2442, lon: 68.4100, region: "Ø³Ù†Ø¯Ú¾", offset: -5 },
        "ØªÚ¾Ø±Ù¾Ø§Ø±Ú©Ø±": { lat: 24.9167, lon: 70.2000, region: "Ø³Ù†Ø¯Ú¾", offset: 2 },
        "ØªÚ¾Ù¹Û": { lat: 24.7470, lon: 67.9250, region: "Ø³Ù†Ø¯Ú¾", offset: 1 },
        "Ø¹Ù…Ø±Ú©ÙˆÙ¹": { lat: 25.3636, lon: 69.7361, region: "Ø³Ù†Ø¯Ú¾", offset: 1 },
        "Ù†ÙˆØ´ÛØ±Ùˆ ÙÛŒØ±ÙˆØ²": { lat: 26.8333, lon: 68.1167, region: "Ø³Ù†Ø¯Ú¾", offset: -6 },
        "Ø³Ù†Ú¯Ú¾Ú‘": { lat: 26.0333, lon: 68.9333, region: "Ø³Ù†Ø¯Ú¾", offset: -1 },
        "Ø´Ú©Ø§Ø±Ù¾ÙˆØ±": { lat: 28.0000, lon: 68.6500, region: "Ø³Ù†Ø¯Ú¾", offset: -13 },
        "Ù¹Ù†ÚˆÙˆ Ø¢Ø¯Ù…": { lat: 25.7667, lon: 68.6667, region: "Ø³Ù†Ø¯Ú¾", offset: -4 },
        "Ù¹Ù†ÚˆÙˆ Ø§Ù„Ù„Û ÛŒØ§Ø±": { lat: 25.4667, lon: 68.7167, region: "Ø³Ù†Ø¯Ú¾", offset: -3 },
        "Ù¹Ù†ÚˆÙˆ Ù…Ø­Ù…Ø¯ Ø®Ø§Ù†": { lat: 24.8000, lon: 69.2000, region: "Ø³Ù†Ø¯Ú¾", offset: -2 },
        
        // ============== Ù¾Ù†Ø¬Ø§Ø¨ ==============
        "Ù„Ø§ÛÙˆØ±": { lat: 31.5204, lon: 74.3587, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -40 },
        "ÙÛŒØµÙ„ Ø¢Ø¨Ø§Ø¯": { lat: 31.4504, lon: 73.1350, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -32 },
        "Ù…Ù„ØªØ§Ù†": { lat: 30.1575, lon: 71.5249, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -25 },
        "Ú¯ÙˆØ¬Ø±Ø§Ù†ÙˆØ§Ù„Û": { lat: 32.1877, lon: 74.1945, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -42 },
        "Ø³Ø±Ú¯ÙˆØ¯Ú¾Ø§": { lat: 32.0836, lon: 72.6711, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -35 },
        "Ø¨ÛØ§ÙˆÙ„Ù¾ÙˆØ±": { lat: 29.3544, lon: 71.6911, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -26 },
        "Ø³ÛŒØ§Ù„Ú©ÙˆÙ¹": { lat: 32.4945, lon: 74.5229, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -44 },
        "Ø±Ø­ÛŒÙ… ÛŒØ§Ø± Ø®Ø§Ù†": { lat: 28.4212, lon: 70.2952, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -18 },
        "Ú¯Ø¬Ø±Ø§Øª": { lat: 32.5742, lon: 74.0754, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -43 },
        "Ø§ÙˆÚ©Ø§Ú‘Û": { lat: 30.8091, lon: 73.4458, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -35 },
        "Ú†Ù†ÛŒÙˆÙ¹": { lat: 31.7200, lon: 72.9789, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -33 },
        "Ø­Ø§ÙØ¸ Ø¢Ø¨Ø§Ø¯": { lat: 32.0709, lon: 73.6850, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -40 },
        "Ø§Ù¹Ú©": { lat: 33.7667, lon: 72.3667, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -48 },
        "Ø¨ÛØ§ÙˆÙ„Ù†Ú¯Ø±": { lat: 30.0000, lon: 73.2500, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -31 },
        "Ø¨Ú¾Ú©Ø±": { lat: 31.6167, lon: 71.0667, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -22 },
        "Ú†Ú©ÙˆØ§Ù„": { lat: 32.9333, lon: 72.8500, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -45 },
        "Ú†Ø´ØªÛŒØ§Úº": { lat: 29.8000, lon: 72.8500, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -28 },
        "ÚˆÛŒØ±Û ØºØ§Ø²ÛŒ Ø®Ø§Ù†": { lat: 30.0500, lon: 70.6333, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -18 },
        "Ú¯ÙˆØ¬Ø±Ø®Ø§Ù†": { lat: 33.1500, lon: 73.3000, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -45 },
        "Ø¬Ú¾Ù†Ú¯": { lat: 31.2667, lon: 72.3167, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -30 },
        "Ø¬ÛÙ„Ù…": { lat: 32.9333, lon: 73.7333, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -48 },
        "Ù‚ØµÙˆØ±": { lat: 31.1167, lon: 74.4500, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -41 },
        "Ø®Ø§Ù†ÛŒÙˆØ§Ù„": { lat: 30.3000, lon: 71.9333, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -28 },
        "Ù„ÛŒÛ": { lat: 30.9667, lon: 70.9333, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -20 },
        "Ù„ÙˆØ¯Ú¾Ø±Ø§Úº": { lat: 29.5333, lon: 71.6333, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -24 },
        "Ù…ÛŒØ§Ù†ÙˆØ§Ù„ÛŒ": { lat: 32.5833, lon: 71.5500, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -22 },
        "Ù…Ø¸ÙØ± Ú¯Ú‘Ú¾": { lat: 30.0667, lon: 71.2000, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -21 },
        "Ù†Ø§Ø±ÙˆÙˆØ§Ù„": { lat: 32.1000, lon: 74.8667, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -46 },
        "Ù†Ù†Ú©Ø§Ù†Û ØµØ§Ø­Ø¨": { lat: 31.4500, lon: 73.7000, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -39 },
        "Ù¾Ø§Ú©Ù¾ØªÙ†": { lat: 30.3500, lon: 73.4000, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -37 },
        "Ø±Ø§Ø¬Ù† Ù¾ÙˆØ±": { lat: 29.1000, lon: 70.3167, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -17 },
        "ØµØ§Ø¯Ù‚ Ø¢Ø¨Ø§Ø¯": { lat: 28.2833, lon: 70.1333, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -18 },
        "Ø³Ø§ÛÛŒÙˆØ§Ù„": { lat: 30.6667, lon: 73.1000, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -34 },
        "Ø´ÛŒØ®ÙˆÙ¾ÙˆØ±Û": { lat: 31.7167, lon: 74.0000, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -40 },
        "ØªÙˆØ¨Û Ù¹ÛŒÚ© Ø³Ù†Ú¯Ú¾": { lat: 30.9667, lon: 72.4833, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -37 },
        "ÙˆÛŒÛØ§Ú‘ÛŒ": { lat: 30.0333, lon: 72.3500, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -31 },
        "Ù…Ù†ÚˆÛŒ Ø¨ÛØ§Ø¤Ø§Ù„Ø¯ÛŒÙ†": { lat: 32.5833, lon: 73.5000, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -42 },
        
        // ============== Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§ ==============
        "Ù¾Ø´Ø§ÙˆØ±": { lat: 34.0151, lon: 71.5249, region: "Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§", offset: -24 },
        "Ù…Ø±Ø¯Ø§Ù†": { lat: 34.1982, lon: 72.0231, region: "Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§", offset: -45 },
        "Ù†ÙˆØ´ÛØ±Û": { lat: 34.0151, lon: 71.9748, region: "Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§", offset: -26 },
        "Ø§ÛŒØ¨Ù¹ Ø¢Ø¨Ø§Ø¯": { lat: 34.1558, lon: 73.2194, region: "Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§", offset: -51 },
        "Ø¨Ù†ÙˆÚº": { lat: 32.9833, lon: 70.6000, region: "Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§", offset: -22 },
        "Ø¨Ù¹Ú¯Ø±Ø§Ù…": { lat: 34.6833, lon: 73.0333, region: "Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§", offset: -52 },
        "Ú†Ø§Ø±Ø³Ø¯Û": { lat: 34.1458, lon: 71.7306, region: "Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§", offset: -25 },
        "Ú†ØªØ±Ø§Ù„": { lat: 35.8333, lon: 71.7833, region: "Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§", offset: -56 },
        "ÚˆÛŒØ±Û Ø§Ø³Ù…Ø§Ø¹ÛŒÙ„ Ø®Ø§Ù†": { lat: 31.8333, lon: 70.9167, region: "Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§", offset: -20 },
        "ÛØ±ÛŒ Ù¾ÙˆØ±": { lat: 33.9944, lon: 72.9333, region: "Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§", offset: -49 },
        "Ú©ÙˆÛØ§Ù¹": { lat: 33.5833, lon: 71.4333, region: "Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§", offset: -22 },
        "Ù…Ø§Ù†Ø³ÛØ±Û": { lat: 34.3333, lon: 73.2000, region: "Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§", offset: -52 },
        "ØµÙˆØ§Ø¨ÛŒ": { lat: 34.1167, lon: 72.4667, region: "Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§", offset: -28 },
        "Ø³ÙˆØ§Øª": { lat: 34.7667, lon: 72.3500, region: "Ø®ÛŒØ¨Ø± Ù¾Ø®ØªÙˆÙ†Ø®ÙˆØ§", offset: -52 },
        
        // ============== Ø¨Ù„ÙˆÚ†Ø³ØªØ§Ù† ==============
        "Ú©ÙˆØ¦Ù¹Û": { lat: 30.1798, lon: 66.9750, region: "Ø¨Ù„ÙˆÚ†Ø³ØªØ§Ù†", offset: 12 },
        "Ú¯ÙˆØ§Ø¯Ø±": { lat: 25.1266, lon: 62.3225, region: "Ø¨Ù„ÙˆÚ†Ø³ØªØ§Ù†", offset: 36 },
        "Ø®Ø¶Ø¯Ø§Ø±": { lat: 27.8000, lon: 66.6167, region: "Ø¨Ù„ÙˆÚ†Ø³ØªØ§Ù†", offset: 18 },
        "Ù„Ø³Ø¨ÛŒÙ„Û": { lat: 26.8333, lon: 66.6167, region: "Ø¨Ù„ÙˆÚ†Ø³ØªØ§Ù†", offset: 9 },
        "Ú˜ÙˆØ¨": { lat: 31.3333, lon: 69.4500, region: "Ø¨Ù„ÙˆÚ†Ø³ØªØ§Ù†", offset: 20 },
        "Ú†Ø§ØºÛŒ": { lat: 29.3167, lon: 63.5833, region: "Ø¨Ù„ÙˆÚ†Ø³ØªØ§Ù†", offset: 42 },
        "Ù‚Ù„Ø§Øª": { lat: 29.0167, lon: 66.5833, region: "Ø¨Ù„ÙˆÚ†Ø³ØªØ§Ù†", offset: 20 },
        
        // ============== Ú¯Ù„Ú¯Øª Ø¨Ù„ØªØ³ØªØ§Ù† ==============
        "Ú¯Ù„Ú¯Øª": { lat: 35.9201, lon: 74.3087, region: "Ú¯Ù„Ú¯Øª Ø¨Ù„ØªØ³ØªØ§Ù†", offset: -70 },
        "Ø³Ú©Ø±Ø¯Ùˆ": { lat: 35.3247, lon: 75.6209, region: "Ú¯Ù„Ú¯Øª Ø¨Ù„ØªØ³ØªØ§Ù†", offset: -75 },
        "ÛÙ†Ø²Û": { lat: 36.3167, lon: 74.6500, region: "Ú¯Ù„Ú¯Øª Ø¨Ù„ØªØ³ØªØ§Ù†", offset: -72 },
        
        // ============== Ø§Ø³Ù„Ø§Ù… Ø¢Ø¨Ø§Ø¯ ==============
        "Ø§Ø³Ù„Ø§Ù… Ø¢Ø¨Ø§Ø¯": { lat: 33.6844, lon: 73.0479, region: "Ø§Ø³Ù„Ø§Ù… Ø¢Ø¨Ø§Ø¯", offset: -46 },
        "Ø±Ø§ÙˆÙ„Ù¾Ù†ÚˆÛŒ": { lat: 33.5651, lon: 73.0169, region: "Ù¾Ù†Ø¬Ø§Ø¨", offset: -46 },
        
        // ============== Ø¢Ø²Ø§Ø¯ Ú©Ø´Ù…ÛŒØ± ==============
        "Ù…Ø¸ÙØ±Ø¢Ø¨Ø§Ø¯": { lat: 34.3700, lon: 73.4711, region: "Ø¢Ø²Ø§Ø¯ Ú©Ø´Ù…ÛŒØ±", offset: -53 },
        "Ù…ÛŒØ±Ù¾ÙˆØ±": { lat: 33.1500, lon: 73.7500, region: "Ø¢Ø²Ø§Ø¯ Ú©Ø´Ù…ÛŒØ±", offset: -50 }
    };

    // 200+ Ù¾Ø§Ú©Ø³ØªØ§Ù†ÛŒ Ø´ÛØ± Ú©ÛŒ Ù„Ø³Ù¹
    const pkCities = [];
    
    // ÚˆÛŒÙ¹Ø§ Ø¨ÛŒØ³ Ø³Û’ Ø´ÛØ± Ø§ÛŒÚˆ Ú©Ø±ÛŒÚº
    for (let cityName in pakistanCitiesDatabase) {
        let cityData = pakistanCitiesDatabase[cityName];
        let englishName = cityName;
        
        // Ø§Ù†Ú¯Ø±ÛŒØ²ÛŒ Ù†Ø§Ù… Ø¨Ù†Ø§Ø¦ÛŒÚº
        if (cityName === "Ú©Ø±Ø§Ú†ÛŒ") englishName = "Karachi";
        else if (cityName === "Ù„Ø§ÛÙˆØ±") englishName = "Lahore";
        else if (cityName === "Ø§Ø³Ù„Ø§Ù… Ø¢Ø¨Ø§Ø¯") englishName = "Islamabad";
        else if (cityName === "Ø±Ø§ÙˆÙ„Ù¾Ù†ÚˆÛŒ") englishName = "Rawalpindi";
        else if (cityName === "ÙÛŒØµÙ„ Ø¢Ø¨Ø§Ø¯") englishName = "Faisalabad";
        else if (cityName === "Ù…Ù„ØªØ§Ù†") englishName = "Multan";
        else if (cityName === "Ú¯ÙˆØ¬Ø±Ø§Ù†ÙˆØ§Ù„Û") englishName = "Gujranwala";
        else if (cityName === "Ù¾Ø´Ø§ÙˆØ±") englishName = "Peshawar";
        else if (cityName === "Ú©ÙˆØ¦Ù¹Û") englishName = "Quetta";
        else if (cityName === "Ø­ÛŒØ¯Ø±Ø¢Ø¨Ø§Ø¯") englishName = "Hyderabad";
        else if (cityName === "Ø³Ø±Ú¯ÙˆØ¯Ú¾Ø§") englishName = "Sargodha";
        else if (cityName === "Ø¨ÛØ§ÙˆÙ„Ù¾ÙˆØ±") englishName = "Bahawalpur";
        else if (cityName === "Ø³ÛŒØ§Ù„Ú©ÙˆÙ¹") englishName = "Sialkot";
        else if (cityName === "Ø³Ú©Ú¾Ø±") englishName = "Sukkur";
        else if (cityName === "Ù„Ø§Ú‘Ú©Ø§Ù†Û") englishName = "Larkana";
        else if (cityName === "Ù…Ø±Ø¯Ø§Ù†") englishName = "Mardan";
        else if (cityName === "Ø±Ø­ÛŒÙ… ÛŒØ§Ø± Ø®Ø§Ù†") englishName = "Rahim Yar Khan";
        else if (cityName === "Ú¯Ø¬Ø±Ø§Øª") englishName = "Gujrat";
        else if (cityName === "Ú¯Ù„Ú¯Øª") englishName = "Gilgit";
        else if (cityName === "Ø³Ú©Ø±Ø¯Ùˆ") englishName = "Skardu";
        else if (cityName === "Ù…Ø¸ÙØ±Ø¢Ø¨Ø§Ø¯") englishName = "Muzaffarabad";
        else if (cityName === "Ú¯ÙˆØ§Ø¯Ø±") englishName = "Gwadar";
        else englishName = cityName;
        
        pkCities.push({
            n: cityName,
            e: englishName,
            o: cityData.offset,
            region: cityData.region,
            lat: cityData.lat,
            lon: cityData.lon
        });
    }

    // Ù…Ù†ÙØ±Ø¯ Ø´ÛØ±
    const uniqueCities = [];
    const cityNamesSet = new Set();
    pkCities.forEach(city => {
        const key = city.n + city.e;
        if (!cityNamesSet.has(key)) {
            cityNamesSet.add(key);
            uniqueCities.push(city);
        }
    });

    // Ø­Ø±ÙˆÙ ØªÛØ¬ÛŒ Ú©Û’ Ù…Ø·Ø§Ø¨Ù‚ ØªØ±ØªÛŒØ¨
    uniqueCities.sort((a,b) => a.n.localeCompare(b.n));

    // Ø´ÛØ± Ú©Ø§ Ø¢ÙØ³ÛŒÙ¹ Ù†Ú©Ø§Ù„Ù†Û’ Ú©Ø§ ÙÙ†Ú©Ø´Ù† - Ø¨Ø§Ù„Ú©Ù„ Ø¯Ø±Ø³Øª
    function calculateExactOffset(cityName) {
        // Ù¾ÛÙ„Û’ ÚˆÛŒÙ¹Ø§ Ø¨ÛŒØ³ Ù…ÛŒÚº Ú†ÛŒÚ© Ú©Ø±ÛŒÚº
        if (pakistanCitiesDatabase[cityName]) {
            return pakistanCitiesDatabase[cityName].offset;
        }
        
        // Ù¾Ø§Ú©Ø³ØªØ§Ù† Ú©Ø§ Ù…Ø¹ÛŒØ§Ø±ÛŒ ÙˆÙ‚Øª UTC+5 ÛÛ’
        // Ú©Ø±Ø§Ú†ÛŒ Ú©Ø§ Ø·ÙˆÙ„ Ø§Ù„Ø¨Ù„Ø¯ 67.0011 ÛÛ’
        const karachiLon = 67.0011;
        
        // Ø´ÛØ± Ú©Ø§ Ø·ÙˆÙ„ Ø§Ù„Ø¨Ù„Ø¯ Ù…Ø¹Ù„ÙˆÙ… Ú©Ø±Ù†Û’ Ú©ÛŒ Ú©ÙˆØ´Ø´
        let estimatedLon = 67.0011; // ÚˆÛŒÙØ§Ù„Ù¹ Ú©Ø±Ø§Ú†ÛŒ
        
        // Ø´ÛØ± Ú©Û’ Ù†Ø§Ù… Ø³Û’ Ø§Ù†Ø¯Ø§Ø²Û Ù„Ú¯Ø§Ø¦ÛŒÚº
        if (cityName.includes("Ù„Ø§ÛÙˆØ±") || cityName.includes("Lahore")) {
            return -40;
        } else if (cityName.includes("Ú¯ÙˆØ¬Ø±Ø§Ù†ÙˆØ§Ù„Û") || cityName.includes("Gujranwala")) {
            return -42;
        } else if (cityName.includes("Ø§Ø³Ù„Ø§Ù…") || cityName.includes("Islamabad") || cityName.includes("Ø±Ø§ÙˆÙ„Ù¾Ù†ÚˆÛŒ") || cityName.includes("Rawalpindi")) {
            return -46;
        } else if (cityName.includes("ÙÛŒØµÙ„") || cityName.includes("Faisalabad")) {
            return -32;
        } else if (cityName.includes("Ù…Ù„ØªØ§Ù†") || cityName.includes("Multan")) {
            return -25;
        } else if (cityName.includes("Ù¾Ø´Ø§ÙˆØ±") || cityName.includes("Peshawar")) {
            return -24;
        } else if (cityName.includes("Ù…Ø±Ø¯Ø§Ù†") || cityName.includes("Mardan")) {
            return -45;
        } else if (cityName.includes("Ú©ÙˆÛØ§Ù¹") || cityName.includes("Kohat")) {
            return -22;
        } else if (cityName.includes("Ú¯Ù„Ú¯Øª") || cityName.includes("Gilgit")) {
            return -70;
        } else if (cityName.includes("Ø³Ú©Ø±Ø¯Ùˆ") || cityName.includes("Skardu")) {
            return -75;
        } else if (cityName.includes("Ú¯ÙˆØ§Ø¯Ø±") || cityName.includes("Gwadar")) {
            return 36;
        } else if (cityName.includes("Ú©ÙˆØ¦Ù¹Û") || cityName.includes("Quetta")) {
            return 12;
        } else if (cityName.includes("Ø­ÛŒØ¯Ø±Ø¢Ø¨Ø§Ø¯") || cityName.includes("Hyderabad")) {
            return -3;
        } else if (cityName.includes("Ø³Ø±Ú¯ÙˆØ¯Ú¾Ø§") || cityName.includes("Sargodha")) {
            return -35;
        } else if (cityName.includes("Ø¨ÛØ§ÙˆÙ„Ù¾ÙˆØ±") || cityName.includes("Bahawalpur")) {
            return -26;
        } else if (cityName.includes("Ø³ÛŒØ§Ù„Ú©ÙˆÙ¹") || cityName.includes("Sialkot")) {
            return -44;
        } else if (cityName.includes("Ø³Ú©Ú¾Ø±") || cityName.includes("Sukkur")) {
            return -9;
        } else if (cityName.includes("Ù„Ø§Ú‘Ú©Ø§Ù†Û") || cityName.includes("Larkana")) {
            return -8;
        }
        
        // Ø§Ú¯Ø± Ú©Ú†Ú¾ Ù…Ø¹Ù„ÙˆÙ… Ù†Û ÛÙˆ ØªÙˆ Ø´ÛØ± Ú©Û’ Ù†Ø§Ù… Ú©ÛŒ Ù„Ù…Ø¨Ø§Ø¦ÛŒ Ø³Û’ Ø§Ù†Ø¯Ø§Ø²Û
        // Ù…Ø´Ø±Ù‚ÛŒ Ø´ÛØ± = Ø²ÛŒØ§Ø¯Û Ù…Ù†ÙÛŒ, Ù…ØºØ±Ø¨ÛŒ Ø´ÛØ± = Ú©Ù… Ù…Ù†ÙÛŒ ÛŒØ§ Ù…Ø«Ø¨Øª
        const cityLength = cityName.length;
        
        // Ù…Ø´Ø±Ù‚ÛŒ Ù¾Ù†Ø¬Ø§Ø¨ Ú©Û’ Ø´ÛØ±
        if (cityLength > 10) {
            return -35; // Ù…Ø´Ø±Ù‚ÛŒ
        } 
        // Ù…ØºØ±Ø¨ÛŒ Ø¨Ù„ÙˆÚ†Ø³ØªØ§Ù† Ú©Û’ Ø´ÛØ±
        else if (cityLength < 5) {
            return 15; // Ù…ØºØ±Ø¨ÛŒ
        }
        // ÙˆØ³Ø·ÛŒ
        else {
            return -15; // ÙˆØ³Ø·ÛŒ
        }
    }

    // Ù†ÛŒØ§ Ø´ÛØ± Ø¨Ù†Ø§Ù†Û’ Ú©Ø§ ÙÙ†Ú©Ø´Ù† - Ø§Ø¨ Ø¨Ø§Ù„Ú©Ù„ Ø¯Ø±Ø³Øª
    function createNewCity(cityName) {
        // Ø§Ù†Ú¯Ø±ÛŒØ²ÛŒ ÛŒØ§ Ø§Ø±Ø¯Ùˆ Ù…ÛŒÚº Ø´ÛØ± Ú©Ø§ Ù†Ø§Ù…
        let urduName = cityName;
        let englishName = cityName;
        
        // Ø§Ú¯Ø± Ø§Ù†Ú¯Ø±ÛŒØ²ÛŒ Ø­Ø±ÙˆÙ ÛÛŒÚº ØªÙˆ Ø§Ù†Ú¯Ø±ÛŒØ²ÛŒ Ù†Ø§Ù… Ø±Ú©Ú¾ÛŒÚº
        if (/[a-zA-Z]/.test(cityName)) {
            englishName = cityName;
            // Ø§Ù†Ú¯Ø±ÛŒØ²ÛŒ Ù†Ø§Ù… Ú©Ùˆ Ø§Ø±Ø¯Ùˆ Ù…ÛŒÚº ØªØ¨Ø¯ÛŒÙ„ Ú©Ø±Ù†Û’ Ú©ÛŒ Ú©ÙˆØ´Ø´
            if (cityName.toLowerCase() === "karachi") urduName = "Ú©Ø±Ø§Ú†ÛŒ";
            else if (cityName.toLowerCase() === "lahore") urduName = "Ù„Ø§ÛÙˆØ±";
            else if (cityName.toLowerCase() === "islamabad") urduName = "Ø§Ø³Ù„Ø§Ù… Ø¢Ø¨Ø§Ø¯";
            else if (cityName.toLowerCase() === "rawalpindi") urduName = "Ø±Ø§ÙˆÙ„Ù¾Ù†ÚˆÛŒ";
            else if (cityName.toLowerCase() === "faisalabad") urduName = "ÙÛŒØµÙ„ Ø¢Ø¨Ø§Ø¯";
            else if (cityName.toLowerCase() === "multan") urduName = "Ù…Ù„ØªØ§Ù†";
            else if (cityName.toLowerCase() === "gujranwala") urduName = "Ú¯ÙˆØ¬Ø±Ø§Ù†ÙˆØ§Ù„Û";
            else if (cityName.toLowerCase() === "peshawar") urduName = "Ù¾Ø´Ø§ÙˆØ±";
            else if (cityName.toLowerCase() === "quetta") urduName = "Ú©ÙˆØ¦Ù¹Û";
            else if (cityName.toLowerCase() === "hyderabad") urduName = "Ø­ÛŒØ¯Ø±Ø¢Ø¨Ø§Ø¯";
            else if (cityName.toLowerCase() === "gilgit") urduName = "Ú¯Ù„Ú¯Øª";
            else if (cityName.toLowerCase() === "skardu") urduName = "Ø³Ú©Ø±Ø¯Ùˆ";
            else if (cityName.toLowerCase() === "gwadar") urduName = "Ú¯ÙˆØ§Ø¯Ø±";
            else urduName = cityName;
        } else {
            urduName = cityName;
            // Ø§Ø±Ø¯Ùˆ Ù†Ø§Ù… Ú©Ùˆ Ø§Ù†Ú¯Ø±ÛŒØ²ÛŒ Ù…ÛŒÚº ØªØ¨Ø¯ÛŒÙ„ Ú©Ø±Ù†Û’ Ú©ÛŒ Ú©ÙˆØ´Ø´
            if (cityName === "Ú©Ø±Ø§Ú†ÛŒ") englishName = "Karachi";
            else if (cityName === "Ù„Ø§ÛÙˆØ±") englishName = "Lahore";
            else if (cityName === "Ø§Ø³Ù„Ø§Ù… Ø¢Ø¨Ø§Ø¯") englishName = "Islamabad";
            else if (cityName === "Ø±Ø§ÙˆÙ„Ù¾Ù†ÚˆÛŒ") englishName = "Rawalpindi";
            else if (cityName === "ÙÛŒØµÙ„ Ø¢Ø¨Ø§Ø¯") englishName = "Faisalabad";
            else if (cityName === "Ù…Ù„ØªØ§Ù†") englishName = "Multan";
            else if (cityName === "Ú¯ÙˆØ¬Ø±Ø§Ù†ÙˆØ§Ù„Û") englishName = "Gujranwala";
            else if (cityName === "Ù¾Ø´Ø§ÙˆØ±") englishName = "Peshawar";
            else if (cityName === "Ú©ÙˆØ¦Ù¹Û") englishName = "Quetta";
            else if (cityName === "Ø­ÛŒØ¯Ø±Ø¢Ø¨Ø§Ø¯") englishName = "Hyderabad";
            else if (cityName === "Ú¯Ù„Ú¯Øª") englishName = "Gilgit";
            else if (cityName === "Ø³Ú©Ø±Ø¯Ùˆ") englishName = "Skardu";
            else if (cityName === "Ú¯ÙˆØ§Ø¯Ø±") englishName = "Gwadar";
            else englishName = cityName;
        }
        
        // Ø´ÛØ± Ú©Ø§ ØµØ­ÛŒØ­ Ø¢ÙØ³ÛŒÙ¹ Ù†Ú©Ø§Ù„ÛŒÚº
        const offset = calculateExactOffset(urduName);
        
        // Ù†ÛŒØ§ Ø´ÛØ± Ø¨Ù†Ø§Ø¦ÛŒÚº
        const newCity = {
            n: urduName,
            e: englishName,
            o: offset,
            isNew: true,
            lat: null,
            lon: null
        };
        
        return newCity;
    }

    const baseData = {
        0: {s:["05:50","07:18","11:09","12:36","04:18","05:58","07:18"], e:["05:48","07:16","11:18","12:46","04:39","06:20","07:37"]},
        1: {s:["05:47","07:16","11:18","12:46","04:40","06:21","07:38"], e:["05:27","06:58","11:18","12:46","04:56","06:38","07:54"]},
        2: {s:["05:26","06:57","11:18","12:46","04:56","06:38","07:54"], e:["04:55","06:24","11:10","12:38","05:08","06:53","08:11"]},
        3: {s:["04:54","06:23","11:10","12:37","05:08","06:54","08:11"], e:["04:26","05:57","11:03","12:32","05:16","07:08","08:31"]},
        4: {s:["04:25","05:56","11:03","12:31","05:16","07:09","08:32"], e:["04:09","05:42","11:03","12:32","05:26","07:25","08:56"]},
        5: {s:["04:09","05:42","11:03","12:32","05:27","07:25","08:57"], e:["04:13","05:45","11:09","12:38","05:35","07:33","09:07"]},
        6: {s:["04:13","05:45","11:09","12:38","05:35","07:33","09:07"], e:["04:31","05:57","11:14","12:40","05:34","07:24","08:53"]},
        7: {s:["04:31","05:58","11:14","12:40","05:33","07:24","08:52"], e:["04:48","06:10","11:10","12:34","05:15","07:00","08:21"]},
        8: {s:["04:48","06:10","11:10","12:33","05:14","06:59","08:20"], e:["05:00","06:20","11:00","12:23","04:47","06:29","07:47"]},
        9: {s:["05:01","06:21","11:00","12:23","04:46","06:28","07:46"], e:["05:15","06:35","11:05","12:17","04:19","06:05","07:24"]},
        10: {s:["05:15","06:36","10:54","12:17","04:18","06:04","07:24"], e:["05:34","06:54","11:00","12:22","04:07","05:56","07:17"]},
        11: {s:["05:35","06:55","11:01","12:23","04:07","05:56","07:18"], e:["05:52","07:17","11:15","12:37","04:18","06:09","07:31"]}
    };

    // Ø´ÛØ± Ú©Ø§ ÚˆÛŒÙ¹Ø§
    let selectedCity = {n: "Ú©Ø±Ø§Ú†ÛŒ", e: "Karachi", o: 0};

    // ØªÙ„Ø§Ø´ Ú©Ø±Ù†Û’ Ú©Ø§ ÙÙ†Ú©Ø´Ù†
    function searchCities(searchText) {
        if (!searchText || searchText.trim() === '') {
            return uniqueCities.slice(0, 15);
        }
        
        const text = searchText.trim().toLowerCase();
        
        // Ù¾ÛÙ„Û’ Ù…ÙˆØ¬ÙˆØ¯Û Ø´ÛØ±ÙˆÚº Ù…ÛŒÚº ØªÙ„Ø§Ø´ Ú©Ø±ÛŒÚº
        let matches = uniqueCities.filter(city => 
            city.n.includes(text) || 
            city.e.toLowerCase().includes(text)
        );
        
        return matches.slice(0, 15);
    }

    function tToM(t) { const [h, m] = t.split(':').map(Number); return h * 60 + m; }
    function mToT(m) { let c = (m + 1440) % 1440; return `${String(Math.floor(c/60)).padStart(2,'0')}:${String(c%60).padStart(2,'0')}`; }
    function rndJ(m, off) { return Math.ceil((m + off) / 15) * 15; }

    function getHijriDate() {
        const months = [
            "Ù…Ø­Ø±Ù… Ø§Ù„Ø­Ø±Ø§Ù…", "ØµÙØ± Ø§Ù„Ù…Ø¸ÙØ±", "Ø±Ø¨ÛŒØ¹ Ø§Ù„Ø§ÙˆÙ„", "Ø±Ø¨ÛŒØ¹ Ø§Ù„Ø«Ø§Ù†ÛŒ", 
            "Ø¬Ù…Ø§Ø¯ÛŒ Ø§Ù„Ø§ÙˆÙ„", "Ø¬Ù…Ø§Ø¯ÛŒ Ø§Ù„Ø«Ø§Ù†ÛŒ", "Ø±Ø¬Ø¨ Ø§Ù„Ù…Ø±Ø¬Ø¨", "Ø´Ø¹Ø¨Ø§Ù† Ø§Ù„Ù…Ø¹Ø¸Ù…", 
            "Ø±Ù…Ø¶Ø§Ù† Ø§Ù„Ù…Ø¨Ø§Ø±Ú©", "Ø´ÙˆØ§Ù„ Ø§Ù„Ù…Ú©Ø±Ù…", "Ø°ÙˆØ§Ù„Ù‚Ø¹Ø¯Ûƒ Ø§Ù„Ø­Ø±Ø§Ù…", "Ø°ÙˆØ§Ù„Ø­Ø¬Ûƒ Ø§Ù„Ø­Ø±Ø§Ù…"
        ];
        
        const today = new Date();
        const day = 23;
        const month = 7;
        const year = 1447;
        
        return `${day} ${months[month]} ${year}Ú¾`;
    }

    // Ø³Ø±Ú† ÚˆØ±Ø§Ù¾ ÚˆØ§Ø¤Ù† Ø§Ù¾ÚˆÛŒÙ¹
    function updateDropdown(searchText = '') {
        const dropdown = document.getElementById('cityDropdown');
        dropdown.innerHTML = '';
        
        const filteredCities = searchCities(searchText);
        
        if (filteredCities.length === 0 && searchText.trim() !== '') {
            // Ù†ÛŒØ§ Ø´ÛØ± Ø¨Ù†Ø§Ù†Û’ Ú©Ø§ Ø¢Ù¾Ø´Ù†
            const newCityItem = document.createElement('div');
            newCityItem.className = 'city-item';
            newCityItem.style.background = '#fff9c4';
            
            const newBadge = document.createElement('span');
            newBadge.className = 'new-city-badge';
            newBadge.innerText = 'Ù†ÛŒØ§ Ø´ÛØ±';
            
            const cityName = document.createElement('span');
            cityName.className = 'city-name-urdu';
            cityName.innerText = searchText;
            
            newCityItem.appendChild(newBadge);
            newCityItem.appendChild(cityName);
            
            newCityItem.onclick = () => {
                selectedCity = createNewCity(searchText);
                document.getElementById('citySearch').value = selectedCity.n;
                dropdown.classList.remove('active');
                
                // Ù†ÛŒØ§ Ø´ÛØ± Ù…ÛŒØ³Ø¬ Ø¯Ú©Ú¾Ø§Ø¦ÛŒÚº
                const messageDiv = document.getElementById('newCityMessage');
                messageDiv.style.display = 'block';
                let offsetText = '';
                if (selectedCity.o > 0) {
                    offsetText = `${selectedCity.o} Ù…Ù†Ù¹ Ø¢Ú¯Û’`;
                } else if (selectedCity.o < 0) {
                    offsetText = `${Math.abs(selectedCity.o)} Ù…Ù†Ù¹ Ù¾ÛŒÚ†Ú¾Û’`;
                } else {
                    offsetText = `Ú©Ø±Ø§Ú†ÛŒ Ú©Û’ Ø¨Ø±Ø§Ø¨Ø±`;
                }
                messageDiv.innerHTML = `âœ¨ Ù†ÛŒØ§ Ø´ÛØ± "${selectedCity.n}" Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ù† Ú¯ÛŒØ§ ÛÛ’Û”<br>ğŸ“ Ù…Ù‚Ø§Ù…ÛŒ ÙˆÙ‚Øª: Ú©Ø±Ø§Ú†ÛŒ Ø³Û’ ${offsetText}<br>ğŸ•Œ Ù†Ù…Ø§Ø² Ú©Û’ Ø§ÙˆÙ‚Ø§Øª Ø¯Ø§Ø±Ø§Ù„Ø§ÙØªØ§Ø¡ Ø§ÛÙ„Ø³Ù†Øª Ú©Û’ Ù…Ø·Ø§Ø¨Ù‚`;
                
                renderApp();
            };
            
            dropdown.appendChild(newCityItem);
        } else {
            filteredCities.forEach(city => {
                const item = document.createElement('div');
                item.className = 'city-item';
                if (selectedCity && selectedCity.n === city.n) {
                    item.classList.add('selected');
                }
                
                const urduName = document.createElement('span');
                urduName.className = 'city-name-urdu';
                urduName.innerText = city.n;
                
                const engName = document.createElement('span');
                engName.className = 'city-name-english';
                engName.innerText = city.e;
                
                item.appendChild(urduName);
                item.appendChild(engName);
                
                item.onclick = () => {
                    selectedCity = city;
                    document.getElementById('citySearch').value = city.n;
                    dropdown.classList.remove('active');
                    
                    // Ù†ÛŒØ§ Ø´ÛØ± Ù…ÛŒØ³Ø¬ Ú†Ú¾Ù¾Ø§Ø¦ÛŒÚº
                    document.getElementById('newCityMessage').style.display = 'none';
                    
                    renderApp();
                };
                
                dropdown.appendChild(item);
            });
        }
        
        dropdown.classList.add('active');
    }

    // Ø´ÛØ± Ø³Ø±Ú† Ø§Ù†Ù¾Ù¹
    const searchInput = document.getElementById('citySearch');
    const dropdown = document.getElementById('cityDropdown');

    searchInput.addEventListener('input', function(e) {
        updateDropdown(e.target.value);
    });

    searchInput.addEventListener('focus', function() {
        updateDropdown(this.value);
    });

    // Ø¨Ø§ÛØ± Ú©Ù„Ú© Ú©Ø±Ù†Û’ Ù¾Ø± ÚˆØ±Ø§Ù¾ ÚˆØ§Ø¤Ù† Ø¨Ù†Ø¯
    document.addEventListener('click', function(e) {
        if (!searchInput.contains(e.target) && !dropdown.contains(e.target)) {
            dropdown.classList.remove('active');
        }
    });

    // Ø§Ù†Ù¹Ø± Ú©ÛŒ Ù¾Ø±ÛŒØ³
    searchInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            e.preventDefault();
            const searchText = this.value.trim();
            
            if (searchText === '') return;
            
            const existingCity = uniqueCities.find(city => 
                city.n === searchText || city.e.toLowerCase() === searchText.toLowerCase()
            );
            
            if (existingCity) {
                selectedCity = existingCity;
                document.getElementById('newCityMessage').style.display = 'none';
            } else {
                // Ù†ÛŒØ§ Ø´ÛØ± Ø¨Ù†Ø§Ø¦ÛŒÚº
                selectedCity = createNewCity(searchText);
                
                // Ù†ÛŒØ§ Ø´ÛØ± Ù…ÛŒØ³Ø¬ Ø¯Ú©Ú¾Ø§Ø¦ÛŒÚº
                const messageDiv = document.getElementById('newCityMessage');
                messageDiv.style.display = 'block';
                let offsetText = '';
                if (selectedCity.o > 0) {
                    offsetText = `${selectedCity.o} Ù…Ù†Ù¹ Ø¢Ú¯Û’`;
                } else if (selectedCity.o < 0) {
                    offsetText = `${Math.abs(selectedCity.o)} Ù…Ù†Ù¹ Ù¾ÛŒÚ†Ú¾Û’`;
                } else {
                    offsetText = `Ú©Ø±Ø§Ú†ÛŒ Ú©Û’ Ø¨Ø±Ø§Ø¨Ø±`;
                }
                messageDiv.innerHTML = `âœ¨ Ù†ÛŒØ§ Ø´ÛØ± "${selectedCity.n}" Ø®ÙˆØ¯Ú©Ø§Ø± Ø¨Ù† Ú¯ÛŒØ§ ÛÛ’Û”<br>ğŸ“ Ù…Ù‚Ø§Ù…ÛŒ ÙˆÙ‚Øª: Ú©Ø±Ø§Ú†ÛŒ Ø³Û’ ${offsetText}<br>ğŸ•Œ Ù†Ù…Ø§Ø² Ú©Û’ Ø§ÙˆÙ‚Ø§Øª Ø¯Ø§Ø±Ø§Ù„Ø§ÙØªØ§Ø¡ Ø§ÛÙ„Ø³Ù†Øª Ú©Û’ Ù…Ø·Ø§Ø¨Ù‚`;
            }
            
            this.value = selectedCity.n;
            dropdown.classList.remove('active');
            renderApp();
        }
    });

    function renderApp() {
        const mi = parseInt(document.getElementById('monthSelect').value);
        const co = selectedCity.o;
        const cn = selectedCity.n;
        const ce = selectedCity.e;
        const tb = document.getElementById('tableContent');
        const now = new Date();
        const dCount = new Date(2026, mi + 1, 0).getDate();
        
        // Ø´ÛØ± Ú©Ø§ Ù†Ø§Ù… Ø¯Ú©Ú¾Ø§Ø¦ÛŒÚº
        let cityDisplay = `${cn}`;
        if (selectedCity.isNew) {
            cityDisplay += ` <span style="font-size:12px; background:var(--accent); color:black; padding:2px 8px; border-radius:12px;">Ù†ÛŒØ§ Ø´ÛØ±</span>`;
        }
        cityDisplay += ` <span style="font-size:12px; opacity:0.8;">(${ce})</span>`;
        document.getElementById('cityNameLabel').innerHTML = cityDisplay;
        
        // Ù¹Ø§Ø¦Ù… Ø²ÙˆÙ† Ú©ÛŒ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
        let offsetText = '';
        if (selectedCity.o > 0) {
            offsetText = `ğŸ“ ${cn} Ú©Ø§ ÙˆÙ‚Øª Ú©Ø±Ø§Ú†ÛŒ Ø³Û’ ${selectedCity.o} Ù…Ù†Ù¹ Ø¢Ú¯Û’ ÛÛ’`;
        } else if (selectedCity.o < 0) {
            offsetText = `ğŸ“ ${cn} Ú©Ø§ ÙˆÙ‚Øª Ú©Ø±Ø§Ú†ÛŒ Ø³Û’ ${Math.abs(selectedCity.o)} Ù…Ù†Ù¹ Ù¾ÛŒÚ†Ú¾Û’ ÛÛ’`;
        } else {
            offsetText = `ğŸ“ ${cn} Ú©Ø§ ÙˆÙ‚Øª Ú©Ø±Ø§Ú†ÛŒ Ú©Û’ Ø¨Ø±Ø§Ø¨Ø± ÛÛ’`;
        }
        document.getElementById('timezoneDisplay').innerHTML = offsetText;
        
        document.getElementById('citySearch').value = cn;
        tb.innerHTML = '';

        for (let d = 1; d <= dCount; d++) {
            let t = [];
            for (let i = 0; i < 7; i++) {
                let sm = tToM(baseData[mi].s[i]), em = tToM(baseData[mi].e[i]);
                let b = sm + Math.round(((em - sm) / (dCount - 1)) * (d - 1));
                t.push(mToT(b + co));
            }

            const sunriseM = tToM(t[1]), dahwaM = tToM(t[2]);
            const ishraq = mToT(sunriseM + 20);
            const chasht = mToT(sunriseM + Math.round((dahwaM - sunriseM) / 2));
            const zw = mToT(tToM(t[3]) - 20); 

            const jF = mToT(rndJ(tToM(t[0]), 25)), jZ = "01:30", jA = mToT(rndJ(tToM(t[4]), 20)), jM = mToT(tToM(t[5]) + 3), jI = mToT(rndJ(tToM(t[6]), 30));

            const isT = (mi === now.getMonth() && d === now.getDate());
            const row = document.createElement('tr'); 
            if (isT) row.className = 'active-day';
            row.innerHTML = `<td>${d}</td><td>${t[0]}<span class="j-mini">Ø¬: ${jF}</span></td><td>${t[1]}</td><td>${ishraq}</td><td>${chasht}</td><td>${t[2]}</td><td class="danger">${zw}</td><td>${t[3]}<span class="j-mini">Ø¬: ${jZ}</span></td><td>${t[4]}<span class="j-mini">Ø¬: ${jA}</span></td><td>${t[5]}<span class="j-mini">Ø¬: ${jM}</span></td><td>${t[6]}<span class="j-mini">Ø¬: ${jI}</span></td>`;
            tb.appendChild(row);

            if (isT) {
                const ms = ["Ø¬Ù†ÙˆØ±ÛŒ","ÙØ±ÙˆØ±ÛŒ","Ù…Ø§Ø±Ú†","Ø§Ù¾Ø±ÛŒÙ„","Ù…Ø¦ÛŒ","Ø¬ÙˆÙ†","Ø¬ÙˆÙ„Ø§Ø¦ÛŒ","Ø§Ú¯Ø³Øª","Ø³ØªÙ…Ø¨Ø±","Ø§Ú©ØªÙˆØ¨Ø±","Ù†ÙˆÙ…Ø¨Ø±","Ø¯Ø³Ù…Ø¨Ø±"];
                const hijriStr = getHijriDate();
                document.getElementById('fullDateDisplay').innerHTML = `Ø¢Ø¬ Ú©Û’ Ø§ÙˆÙ‚Ø§Øª: ${d} ${ms[mi]} ${now.getFullYear()}Ø¡ | <span class="hijri-date">Ø§Ø³Ù„Ø§Ù…ÛŒ ØªØ§Ø±ÛŒØ®: ${hijriStr}</span>`;
                
                const grid = document.getElementById('cardGrid'); 
                grid.innerHTML = '';
                const display = [
                    {l:"ÙØ¬Ø±",v:t[0],j:jF}, {l:"Ø·Ù„ÙˆØ¹",v:t[1]}, {l:"Ø§Ø´Ø±Ø§Ù‚",v:ishraq}, {l:"Ú†Ø§Ø´Øª",v:chasht},
                    {l:"Ø¶Ø­ÙˆÛƒ",v:t[2]}, {l:"Ù…Ù…Ù†ÙˆØ¹",v:zw,w:true}, {l:"Ø¸ÛØ±",v:t[3],j:jZ},
                    {l:"Ø¹ØµØ±",v:t[4],j:jA}, {l:"Ù…ØºØ±Ø¨",v:t[5],j:jM}, {l:"Ø¹Ø´Ø§Ø¡",v:t[6],j:jI}
                ];
                display.forEach(i => { 
                    grid.innerHTML += `<div class="time-box"><span class="t-label ${i.w?'danger':''}">${i.l}</span><span class="t-val">${i.v}</span>${i.j?`<span class="j-tag">Ø¬Ù…Ø§Ø¹Øª: ${i.j}</span>`:''}</div>`; 
                });
            }
        }
    }
    
    // ÚˆÛŒÙØ§Ù„Ù¹ Ú©Ø±Ø§Ú†ÛŒ
    document.getElementById('citySearch').value = selectedCity.n;
    document.getElementById('monthSelect').value = new Date().getMonth(); 
    renderApp();
</script>
</body>
</html>
